%% INPUT DATA SAMPLE
% Nodes
% Ala arriba - delante
cord (1,:) =  [-6,0,0];
cord (2,:) =  [-4,0,0];
cord (3,:) =  [-1,0,0];
cord (4,:) =  [0,0,0];
cord (5,:) =  [1,0,0];
cord (6,:) =  [4,0,0];
cord (7,:) =  [6,0,0];

% Ala arriba - detras
cord (8,:) =  [-6,-1,0];
cord (9,:) =  [-4,-1.3,0];
cord (10,:) =  [-1,-1.5,0];
cord (11,:) =  [0,-1.5,0];
cord (12,:) =  [1,-1.5,0];
cord (13,:) =  [4,-1.3,0];
cord (14,:) =  [6,-1,0];

% Ala abajo - delante
cord (15,:) =  [-6,0,-0.2];
cord (16,:) =  [-4,0,-0.2];
cord (17,:) =  [-1,0,-0.2];
cord (18,:) =  [0,0,-0.2];
cord (19,:) =  [1,0,-0.2];
cord (20,:) =  [4,0,-0.2];
cord (21,:) =  [6,0,-0.2];

% Ala abajo - detras
cord (22,:) =  [-6,-1,-0.2];
cord (23,:) =  [-4,-1.3,-0.2];
cord (24,:) =  [-1,-1.5,-0.2];
cord (25,:) =  [0,-1.5,-0.2];
cord (26,:) =  [1,-1.5,-0.2];
cord (27,:) =  [4,-1.3,-0.2];
cord (28,:) =  [6,-1,-0.2];

% Cockpit por debajo
cord (29,:) =  [-1,0,-1.5];
cord (30,:) =  [1,0,-1.5];
cord (31,:) =  [-1,-1.5,-1.5];
cord (32,:) =  [1,-1.5,-1.5];


cord (33,:) =  [-1,1,-0.5]; 
cord (34,:) =  [1,1,-0.5]; 

cord (35,:) =  [0,2,-1];

cord (36,:) =  [-1,1,-1.5];
cord (37,:) =  [1,1,-1.5];

% ATRAS 
cord (38,:) =  [-1,-2.5,0];
cord (39,:) =  [1,-2.5,0];
cord (40,:) =  [-0.7,-4,0];
cord (41,:) =  [0.7,-4,0];

cord (42,:) =  [-1,-2.5,-1.5];
cord (43,:) =  [1,-2.5,-1.5];
cord (44,:) =  [-0.7,-4,-0.7];
cord (45,:) =  [0.7,-4,-0.7];

%Cola
cord (46,:) =  [-2,-7,0];
cord (47,:) =  [-0.5,-7,0];
cord (48,:) =  [0,-7,0];
cord (49,:) =  [0.5,-7,0];
cord (50,:) =  [2,-7,0];

cord (51,:) =  [-2,-8,0];
cord (52,:) =  [0,-8,0];
cord (53,:) =  [2,-8,0];

% 

% % Cockpit por delante - arriba
% cord (29,:) =  [-1,1,-0.5];
% cord (30,:) =  [-0.5,2,-1];
% cord (31,:) =  [0.5,2,-1];
% cord (32,:) =  [1,1,-0.5];
% 
% % Cockpit por delante - abajo
% cord (33,:) =  [-1,0,-1.5]; 
% cord (34,:) =  [1,0,-1.5]; 
% cord (35,:) =  [-1,1,-1.5];
% cord (36,:) =  [1,1,-1.5];
% 
% % Cockpit por delante - arriba
% cord (37,:) =  [-1,-2.5,0];
% cord (38,:) =  [1,-2.5,0];
% cord (39,:) =  [-0.7,-4,0];
% cord (40,:) =  [0.7,-4,0];
% cord (41,:) =  [-0.5,-5.5,0];
% cord (42,:) =  [0.5,-5.5,0];
% 
% % Cola
% cord (43,:) =  [-2,-7,0];
% cord (44,:) =  [-0.5,-7,0];
% cord (45,:) =  [0.5,-7,0];
% cord (46,:) =  [2,-7,0];
% cord (47,:) =  [-2,-8,0];
% cord (48,:) =  [-0.5,-8,0];
% cord (49,:) =  [0.5,-8,0];
% cord (50,:) =  [2,-8,0];
% 
% 
% cord (51,:) =  [-1,-2.5,-1.5];
% cord (52,:) =  [1,-2.5,-1.5];
% cord (53,:) =  [-0.7,-4,-1];
% cord (54,:) =  [0.7,-4,-1];
% cord (55,:) =  [-0.5,-5.5,-0.5];
% cord (56,:) =  [0.5,-5.5,-0.5];
% 
% cord (57,:) =  [-1,-1.5,-1.5];
% cord (58,:) =  [1,-1.5,-1.5];


input.xpoints = [
  0, 0, 0;           %(1)
  0, 0, -0.2;        %(2)
  0, 1.6, 0;         %(3)
  0, 1.6, -0.2;      %(4)
  2, 0, 0;           %(5)
  4, 0, 0;           %(6)
  6, 0, 0;           %(7)
  8, 0, 0;           %(8)
  10, 0, 0;          %(9)
  12, 0, 0;          %(10)
  2, 1.65, 0;        %(11)
  4, 1.65, 0;        %(12)
  6, 1.65, 0;        %(13)
  8, 1.65, 0;        %(14)
  10, 1.65, 0;        %(15)
  12, 1.65, 0;       %(16)
    2, 0, -0.2;         %(17)
  4, 0, -0.2;           %(18)
  6, 0, -0.2;           %(19)
  8, 0, -0.2;           %(20)
  10, 0, -0.2;           %(21)
  12, 0, -0.2;          %(22)
  2, 1.65, -0.2;        %(23)
  4, 1.65, -0.2;        %(24)
  6, 1.65, -0.2;        %(25)
  8, 1.65, -0.2;        %(26)
  10, 1.65, -0.2;        %(27)
  12, 1.65, -0.2;       %(28)
  6.5, 2.6, -0.6;       %(29)
  7.5, 2.6, -0.6;       %(30)
  6.5, 2.6, -1.1;       %(31)
  7.5, 2.6, -1.1;       %(32)
  7, 3.1, -0.8;       %(33)
  %7.5, 3.1, -0.6;       %(34)
  %6.5, 3.1, -1.1;       %(35)
  %7.5, 3.1, -1.1;       %(36)
  6, 1.6, -1.6;         %(37)
  8, 1.6, -1.6;         %(38)
  8, 0, -1.2;           %(39)
  6, 0, -1.2;           %(40)
  8.5, 1, -2.2;         %(41)
  5.5, 1, -2.2;         %(42)
  7.8,-2, -0.2;       %(43)
  6.2,-2, -0.2;       %(44)
  7.8,-2, -1;         %(45)
  6.2,-2, -1;         %(46)
  7.4,-3.8, -0.2;     %(47)
  6.6,-3.8, -0.2;     %(48)
  7.4,-3.8, -0.6;     %(49)
  6.6,-3.8, -0.6;     %(50)
  7,-5, -0.2;         %(51)
  7,-5, -0.4;         %(52)
  14,0, 0;            %(53)
  14,0, -0.2;         %(54)
  14,1.6, 0;          %(55)
  14,1.6, -0.2;       %(56)
  
  %7-0.8, -4.5, -0.2;          %Añado (57)
  %7+0.8, -4.5 , -0.2;       % Añado (58)
];

for i = 1:size(input.xpoints,1)
    input.xpoints(i,1) = input.xpoints(i,1) - 7;
end

clear cord
    
% Connecticity matrix T(i_elem,i_node)
% Barras horizontales - Ala arriba
T(1,:) = [1,2];
T(2,:) = [2,3];
T(3,:) = [3,4];
T(4,:) = [4,5];
T(5,:) = [5,6];
T(6,:) = [6,7];
T(7,:) = [8,9];
T(8,:) = [9,10];
T(9,:) = [10,11];
T(10,:) = [11,12];
T(11,:) = [12,13];
T(12,:) = [13,14];

% Barras horizontales - Ala abajo
T(13,:) = [15,16];
T(14,:) = [16,17];
T(15,:) = [17,18];
T(16,:) = [18,19];
T(17,:) = [19,20];
T(18,:) = [20,21];
T(19,:) = [22,23];
T(20,:) = [23,24];
T(21,:) = [24,25];
T(22,:) = [25,26];
T(23,:) = [26,27];
T(24,:) = [27,28];

% Barras verticales - Union ala abajo y arriba
T(25,:) = [1,15];
T(26,:) = [2,16];
T(27,:) = [3,17];
T(28,:) = [4,18];
T(29,:) = [5,19];
T(30,:) = [6,20];
T(31,:) = [7,21];
T(32,:) = [8,22];
T(33,:) = [9,23];
T(34,:) = [10,24];
T(35,:) = [11,25];
T(36,:) = [12,26];
T(37,:) = [13,27];
T(38,:) = [14,28];

% Barras Union ala delante y atras

T(39,:) = [1,8];
T(40,:) = [15,22];
T(41,:) = [1,22];

T(42,:) = [2,9];
T(43,:) = [16,23];
T(44,:) = [2,23];

T(45,:) = [3,10];
T(46,:) = [17,24];
T(47,:) = [3,24];

T(48,:) = [4,11];
T(49,:) = [18,25];
T(50,:) = [4,25];

T(51,:) = [5,12]; 
T(52,:) = [19,26];
T(53,:) = [5,26];

T(54,:) = [6,13];
T(55,:) = [20,27];
T(56,:) = [6,27];

T(57,:) = [7,14];
T(58,:) = [21,28];
T(59,:) = [7,28];

T(60,:) = [1,9]; 
T(61,:) = [15,23];

T(62,:) = [2,10];
T(63,:) = [16,24];

T(64,:) = [3,11]; 
T(65,:) = [17,25];

T(66,:) = [5,11];
T(67,:) = [19,25];

T(68,:) = [6,12];
T(69,:) = [20,26];

T(70,:) = [7,13];
T(71,:) = [21,27];

T(72,:) = [17,29];
T(73,:) = [19,30];
T(74,:) = [24,31];
T(75,:) = [26,32];

T(76,:) = [17,33];
%T(77,:) = [29,36];
T(77,:) = [29,33];

%Barras union delante
T(78,:) = [19,34];
T(79,:) = [30,37];

T(80,:) = [18,33];
%T(80,:) = [18,33];
T(81,:) = [18,34];

%T(82,:) = [33,34];
T(83,:) = [33,37];
%T(82,:) = [33,34];

%T(84,:) = [33,35]; 
%T(85,:) = [36,35]; 

%T(86,:) = [34,35];
%T(87,:) = [37,35];

%T(88,:) = [33,36];
%T(89,:) = [34,37];

T(90,:) = [33,17];
T(91,:) = [33,19];

T(92,:) = [29,31];
T(93,:) = [29,24];

T(94,:) = [30,32];
T(95,:) = [30,26];

%Suelo Cabina
T(96,:) = [31,30];
T(97,:) = [32,29];
T(98,:) = [31,32];

T(99,:) = [29,18];
T(100,:) = [30,18];
T(101,:) = [31,25];
T(102,:) = [32,25];

% PARTE ATRAS
T(103,:) = [10,38];
T(104,:) = [31,42];
T(105,:) = [10,42];

T(106,:) = [12,39];
T(107,:) = [32,43];
T(108,:) = [12,43];

T(109,:) = [12,38];
T(110,:) = [42,32];

T(111,:) = [10,39];
T(112,:) = [31,43];

T(113,:) = [38,39];
T(114,:) = [42,43];
T(115,:) = [38,43];
T(116,:) = [39,42];

T(117,:) = [38,42];
T(118,:) = [39,43];

% Mas atras
T(119,:) = [38,40];
T(120,:) = [42,44];

T(121,:) = [39,41];
T(122,:) = [43,45];

T(123,:) = [38,41];
T(124,:) = [42,45];

T(125,:) = [39,40];
T(126,:) = [43,44];

T(127,:) = [40,41];
T(128,:) = [44,45];
T(129,:) = [40,45];
T(130,:) = [41,44];

T(131,:) = [40,44];
T(132,:) = [41,45];

T(133,:) = [42,40];
T(134,:) = [43,41];

% Union cola

T(135,:) = [40,47];
T(136,:) = [44,47];

T(137,:) = [41,49];
T(138,:) = [45,49];

T(139,:) = [40,48];
T(140,:) = [44,48];
T(141,:) = [41,48];
T(142,:) = [45,48];

% Cola
T(143,:) = [46,47];
T(144,:) = [47,48];
T(145,:) = [48,49];
T(146,:) = [49,50];

T(147,:) = [46,51];
T(148,:) = [51,52];
T(149,:) = [52,53];
T(150,:) = [50,53];

T(151,:) = [46,52];
T(152,:) = [47,52];
T(153,:) = [48,52];
T(154,:) = [49,52];
T(155,:) = [50,52];

% Delante motor cruzadas
T(156,:) = [33,37];
T(157,:) = [34,36];

T(158,:) = [15,2];
T(159,:) = [16,3];
T(160,:) = [17,4];
T(161,:) = [19,4];
T(162,:) = [20,5];
T(163,:) = [21,6];

T(164,:) = [22,9];
T(165,:) = [23,10];
T(166,:) = [24,11];
T(167,:) = [26,11];
T(168,:) = [27,12];
T(169,:) = [28,13];

% Suelo cabina
T(170,:) = [29,30];
T(171,:) = [29,37];
T(172,:) = [30,36];

T(173,:) = [17,11];
T(174,:) = [18,11];
T(175,:) = [19,11];


T(176,:) = [1,23];
T(177,:) = [2,24];
T(178,:) = [3,25];
T(179,:) = [5,25];
T(180,:) = [6,26];
T(181,:) = [7,27];


%T(172,:) = [28,13];

%T(109,:) = [32,25];



%T(1,:) = [1,2];
% T(2,:) = [2,3];
% T(3,:) = [3,4];
% T(4,:) = [4,5];
% T(5,:) = [5,6];
% T(6,:) = [6,7];
% T(7,:) = [8,9];
% T(8,:) = [9,10];
% T(9,:) = [10,11];
% T(10,:) = [11,12];
% T(11,:) = [12,13];
% T(12,:) = [13,14];
% 
% T(13,:) = [1,8];
% T(14,:) = [2,9];
% T(15,:) = [3,10];
% T(16,:) = [4,11];
% T(17,:) = [5,12];
% T(18,:) = [6,13];
% T(19,:) = [7,14];
% 
% 
% T(20,:) = [1,15];
% T(21,:) = [2,16];
% T(22,:) = [3,17];
% T(23,:) = [4,18];
% T(24,:) = [5,19];
% T(25,:) = [6,20];
% T(26,:) = [7,21];
% T(27,:) = [8,22];
% T(28,:) = [9,23];
% T(29,:) = [10,24];
% T(30,:) = [11,25];
% T(31,:) = [12,26];
% T(32,:) = [13,27];
% T(33,:) = [14,28];
% 
% 
% T(34,:) = [15,22];
% T(35,:) = [16,23];
% T(36,:) = [17,24];
% T(37,:) = [18,25];
% T(38,:) = [19,26];
% T(39,:) = [20,27];
% T(40,:) = [21,28];
% 
% 
% T(41,:) = [3,29];
% T(42,:) = [5,32];
% T(43,:) = [29,30];
% T(44,:) = [32,31];
% 
% T(45,:) = [33,35];
% T(46,:) = [34,36];
% T(47,:) = [35,30];
% T(48,:) = [36,31];
% 
% 
% T(49,:) = [10,37];
% T(50,:) = [12,38];
% 
% T(51,:) = [57,58]; 
% T(52,:) = [37,39];
% T(53,:) = [38,40];
% 
% 
% 
% T(54,:) = [51,53];
% T(55,:) = [52,54];
% T(56,:) = [51,52];
% 
% T(57,:) = [53,54];
% T(58,:) = [53,55];
% T(59,:) = [54,56];
% T(60,:) = [55,56];
% 
% T(61,:) = [55,44];
% T(62,:) = [56,45];
% T(63,:) = [39,40];
% T(64,:) = [39,41];
% T(65,:) = [40,42];
% T(66,:) = [41,42];
% T(67,:) = [41,44];
% T(68,:) = [42,45];
% T(69,:) = [43,44];
% T(70,:) = [43,47];
% 
% T(71,:) = [47,48];
% T(72,:) = [48,49];
% T(73,:) = [44,48];
% T(74,:) = [45,49];
% T(75,:) = [49,50];
% T(76,:) = [46,50];
% T(77,:) = [45,46];
% T(78,:) = [44,45];
% 
% T(79,:) = [37,38];
% 
% T(80,:) = [41,55]; %%% OJO!
% 
% T(81,:) = [42,56]; %%% OJO!
% T(82,:) = [39,53]; %%% OJO!
% T(83,:) = [40,54]; %%% OJO!
% T(84,:) = [37,51]; %%% OJO!
% T(85,:) = [38,52]; %%% OJO!
% 
% T(86,:) = [35,17];
% T(87,:) = [36,19];
% 
% T(88,:) = [29,32];
% T(89,:) = [35,36];
% T(90,:) = [35,31];
% 
% T(91,:) = [36,30];
% T(92,:) = [30,31];
% 
% T(93,:) = [1,23];
% T(94,:) = [2,24];
% T(95,:) = [3,25];
% T(96,:) = [5,25];
% T(97,:) = [6,26];
% T(98,:) = [7,27];
% T(99,:) = [35,32];
% T(100,:) = [29,36];
% 
% T(101,:) = [33,16];
% T(102,:) = [34,20];
% T(103,:) = [57,23];
% T(104,:) = [58,27];
% 
% T(105,:) = [15,16];
% T(106,:) = [16,17];
% T(107,:) = [17,18];
% T(108,:) = [18,19];
% T(109,:) = [19,20];
% T(110,:) = [20,21];
% T(111,:) = [22,23];
% T(112,:) = [23,24];
% T(113,:) = [24,25];
% T(114,:) = [25,26];
% T(115,:) = [26,27];
% T(116,:) = [27,28];
% 
% T(117,:) = [17,33];
% T(118,:) = [19,34];
% T(119,:) = [24,57];
% T(120,:) = [26,58];
% T(121,:) = [37,51];
% T(122,:) = [38,52];
% 
% T(123,:) = [39,53];
% T(124,:) = [40,54];
% T(125,:) = [41,55];
% T(126,:) = [42,56];
% 
% T(127,:) = [19,32];
% T(128,:) = [17,29];
% 
% T(129,:) = [33,57];
% T(130,:) = [34,58];
% T(131,:) = [57,51];
% T(132,:) = [58,52];
%}

%input.T = T;

input.T = [
     1     3
     1     5
     1     2
     2     17
     2     4
     3     11
     4     23
     3     4
     1     11
     2     23
     5     6
     6     7
     7     8
     8     9
     9    10
    10    16
    11    12
    12    13
    13    14
    14    15
    15    16
     5    11
     6    12
     7    13
     8    14
     9    15
     5    17
     6    18
     7    19
     8    20
     9    21
    10    22
    11    23
    12    24
    13    25
    14    26
    15    27
    16    28
    17    18
    18    19
    19    20
    20    21
    21    22
    22    28
    17    23
    23    24
    24    25
    25    26
    26    27
    27    28
    18    24
    19    25
    20    26
    21    27
     6    11
    18    23
    18    25
     6    13
     7    14
    20    25
     9    14
    21    26
     9    16
    21    28
    25    29
    26    30
    29    30
    31    32
    29    31
    30    32
    29    33
    31 33 %31    35
    30 33 %30    34
    32 33 %32    36
    %34    36
    33  31
    %33    35
    %35    36
    %33    34
    31    37
    32    38
    37    40
    38    39
    26    38
    25    37
    40    19
    20    39
    40    42
    42    37
    38    41
    39    41
    39    45
    20    43
    43    45
    19    44
    40    46
    44    46
    43    47
    44    48
    48    50
    47    49
    45    49
    46    50
    50    52
    48    51
    47    51
    49    52
    51    52
    10    53
    22    54
    53    54
    53    55
    54    56
    16    55
    28    56
    55    56
    16    53
    28    54
    41    37
    42    38
    45    46
    39    40
    49    50
    2     3
    2     5
    5     18
    18    7
    8     21
    21    10
    10    54     
    11    24
    24    13
    14    27
    27    16
    4     11
    16    56
    55    54
    43    44
    47    48
    39    43
    40    44
    39    46
    46    49
    19    43
    43    48
    43    49
    44    50
    50    51
    49    51
    37    38
    %34    35
    %33    36
    30 33%30    36
    29    35
    % Repe: 33 29 %34    29
    33 32 %35    32
    11    17
    12    18
    13    19
    14    20
    15    21
    16    22
    7     20
    14    25
    20    40
    44    45
    26    37
    47    50
    38    40
    37    39
    38    20
    37    19
    26    32
    25    31
    1     23
    23    6
    6     25
    53    28
    28    9
    9     26
    29    32
    26    40
    39    25
    40    43
    44    49
    29    26
    32    37
    
    %ANYADO
    %57 51 
    %57 48
    
    %58 51
    %58 47
    ];

for i=1:size(input.T,1)
    if input.T(i,1) > 33
        input.T(i,1) = input.T(i,1) -3;
    end
    
    if input.T(i,2) > 33
        input.T(i,2) = input.T(i,2) -3;
    end
    
end


clear T
    
% Element properties
E = ones(size(input.T,1),1) * 210e3 ;

input.E = E;

input.A = ones(size(input.T,1),1) ;
input.rho = ones(size(input.T,1),1) * 1;

% BC
input.fixnodes = [29, 1, 0;...
            29, 2, 0;...
            29, 3, 0;...  %Rueda derecha
            30, 1, 0;...
            30, 2, 0;...
            30, 3, 0;...   %Rueda derecha
            48, 1, 0;...
            48, 2, 0;...
            48, 3, 0;... %Nodo superior cola
            31, 1, 0;...
            31, 2, 0;...
            31, 3, 0;... 
            32, 1, 0;...
            32, 2, 0;...
            32, 3, 0;... 
];
              
Lift = 1000;
lift_parcial = Lift / 14;
Masa_motor = 500; g = 9.81;
Motor = Masa_motor*g;
    
input.Fext = [1, 3, lift_parcial;...
              2, 3, lift_parcial;...
              3, 3, lift_parcial;...
              4, 3, lift_parcial; 
              5, 3, lift_parcial;...
              6, 3, lift_parcial;...
              7, 3, lift_parcial;...
              8, 3, lift_parcial;...
              9, 3, lift_parcial;...
              10, 3, lift_parcial;...
              11, 3, lift_parcial;...
              12, 3, lift_parcial;...
              13, 3, lift_parcial;...
              14, 3, lift_parcial;...
              35, 3, -Motor];
              
